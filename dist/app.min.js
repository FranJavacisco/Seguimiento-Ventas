"use strict";var db,salesData=[];function initDB(){var e=indexedDB.open("SalesDB",1);e.onerror=function(e){console.error("Error al abrir la base de datos",e)},e.onsuccess=function(e){db=e.target.result,loadSalesData()},e.onupgradeneeded=function(e){(db=e.target.result).createObjectStore("sales",{keyPath:"id",autoIncrement:!0})}}function loadSalesData(){db.transaction(["sales"],"readonly").objectStore("sales").getAll().onsuccess=function(e){salesData=e.target.result||[]}}function formatNumber(e){var t=e.value.replace(/\D/g,"");e.value=new Intl.NumberFormat("es-ES").format(t)}function discountIVA(e){return e/1.19}function saveSale(){var e=parseFloat(document.getElementById("saleAmount").value.replace(/\./g,""))||0,t=parseFloat(document.getElementById("warrantyAmount").value.replace(/\./g,""))||0,n=parseFloat(document.getElementById("insuranceAmount").value.replace(/\./g,""))||0,o=document.getElementById("productDescription").value||"Sin descripción",a=new Date,r={saleAmount:e,warrantyAmount:t,insuranceAmount:n,productDescription:o,dateString:"".concat(a.toLocaleDateString()," ").concat(a.toLocaleTimeString())};db.transaction(["sales"],"readwrite").objectStore("sales").add(r).onsuccess=function(){salesData.push(r),updateIndicators(r),clearFields(),alert("Venta guardada correctamente")}}function updateIndicators(e){document.getElementById("ventaSinIVA").textContent=discountIVA(e.saleAmount).toFixed(2).toLocaleString("es-ES"),document.getElementById("garantiaSinIVA").textContent=discountIVA(e.warrantyAmount).toFixed(2).toLocaleString("es-ES"),document.getElementById("seguroSinIVA").textContent=discountIVA(e.insuranceAmount).toFixed(2).toLocaleString("es-ES"),document.getElementById("crucePercent").textContent=((e.warrantyAmount+e.insuranceAmount)/e.saleAmount*100).toFixed(2)+"%"}function clearFields(){document.getElementById("saleAmount").value="",document.getElementById("warrantyAmount").value="",document.getElementById("insuranceAmount").value="",document.getElementById("productDescription").value=""}function downloadReport(){db.transaction(["sales"],"readonly").objectStore("sales").getAll().onsuccess=function(e){var t=e.target.result.map(function(e){return{Fecha:e.dateString,"Descripción":e.productDescription,"Monto de Venta":e.saleAmount.toLocaleString("es-ES"),"Monto de Garantía":e.warrantyAmount.toLocaleString("es-ES"),"Monto de Seguro":e.insuranceAmount.toLocaleString("es-ES"),"Monto de Venta Neto (sin IVA)":discountIVA(e.saleAmount).toFixed(2).toLocaleString("es-ES"),"Monto de Garantía Neto (sin IVA)":discountIVA(e.warrantyAmount).toFixed(2).toLocaleString("es-ES"),"Monto de Seguro Neto (sin IVA)":discountIVA(e.insuranceAmount).toFixed(2).toLocaleString("es-ES"),"% Cruce":((e.warrantyAmount+e.insuranceAmount)/e.saleAmount*100).toFixed(2)+"%"}}),n=XLSX.utils.json_to_sheet(t),o=XLSX.utils.book_new();XLSX.utils.book_append_sheet(o,n,"Reporte de Ventas"),XLSX.writeFile(o,"reporte_ventas.xlsx")}}initDB();
//# sourceMappingURL=app.min.js.map
